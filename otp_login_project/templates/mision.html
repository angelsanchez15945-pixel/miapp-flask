<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Misión</title>
        <link rel="icon" href="static/imagenes/titulo.ico" type="image/x-icon">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="{{ url_for('static', filename='session.js') }}"></script>
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet">
        <script src="{{ url_for('static', filename='ping.js') }}"></script>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
     /* RESPONSIVE */
        @media (max-width: 700px) {
          .card-grid { grid-template-columns: 1fr; }
          .partner-grid { grid-template-columns: repeat(2, 1fr); }
        }

        /* NAV INFERIOR ------- MOUSE */
        .bottom-nav {
          position: fixed;
          left: 0; right: 0; bottom: 0;
          display: flex;
          justify-content: space-around;
          background: #fff;
          border-top: 1px solid #e6e6e6;
          padding: 8px 0;
          z-index: 999;
        }

        .nav-item {
          color: #333;
          text-decoration: none;
          font-size: 12px;
          text-align: center;
          transition: all 0.25s ease;
        }

        .nav-item i {
          display: block;
          font-size: 22px;
          margin-bottom: 3px;
          transition: transform 0.25s ease, color 0.25s ease;
        }

        /* EFECTO HOVER ---- MOUSE */
        .nav-item:hover {
          color: #0044FF;   /* CAMBIAR DE COLOR */
          transform: scale(1.1);
          text-shadow: 0 0 6px rgba(15, 234, 245, 0.3);
        }

        .nav-item:hover i {
          transform: scale(1.2);
          color: #0044FF;  /* CAMBIAR DE COLOR */
        }







        
/* Barra de progreso */
.barra-progreso {
    background: rgba(255,255,255,0.2);
    border-radius: 20px;
    height: 20px;
    margin-top: 15px;
    overflow: hidden;
}
.progreso {
    background: #4CAF50;
    height: 100%;
    text-align: center;
    font-size: 0.85rem;
    color: white;
    line-height: 20px;
    font-weight: bold;
}

body {
        font-family: Arial, sans-serif;
        background: #f4f7fa;
        margin: 0;
        padding: 0;
    }
    .saldo {
        padding: 20px;
        font-size: 1.2rem;
        color: #333;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    .saldo small {
        display: block;
        font-size: 0.9rem;
        color: #777;
    }
    /* Botón + */
    .btn-mas {
        background: #0a2c78;
        color: white;
        font-size: 1.5rem;
        border: none;
        border-radius: 50%;
        width: 45px;
        height: 45px;
        cursor: pointer;
        box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        display: flex;
        justify-content: center;
        align-items: center;
        transition: background 0.3s ease;
    }
    .btn-mas:hover {
        background: #08306b;
    }
    .tarjeta {
        background: linear-gradient(135deg, #1E3CBA, #8E44F7);
        border-radius: 12px;
        padding: 20px;
        color: white;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        margin: 0 15px;
    }
    .tarjeta h2 {
        margin: 0;
        font-size: 1.5rem;
    }
    .tarjeta small {
        display: block;
        margin-top: 4px;
        font-size: 0.9rem;
        opacity: 0.85;
    }
    .stats {
        display: flex;
        justify-content: space-around;
        margin-top: 20px;
    }
    .stat {
        text-align: center;
    }
    .stat span {
        display: block;
        font-size: 1.8rem;
        font-weight: bold;
    }
    .stat small {
        font-size: 0.85rem;
        opacity: 0.85;
    }
    .detalle {
        background: white;
        margin: 0 15px;
        padding: 15px;
        border-bottom: 1px solid #eee;
        font-size: 0.9rem;
        display: flex;
        justify-content: space-between;
        color: #555;
    }
    .boton {
    background: #0a2c78;
    color: white;
    text-align: center;
    padding: 15px;
    border-radius: 30px;
    font-weight: bold;
    cursor: pointer;
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    width: 100%; /* Ocupa el ancho del contenedor */
    display: inline-block;
    border: none;
}
.boton:hover {
    background: #08306b;
}
.boton-container {
    max-width: 1700px; /* Tamaño máximo para que ambos se igualen */
    margin: 10px auto; /* Centrado horizontal */
}
    </style>
</head>
<body>



<div class="saldo">
    <div>
         💰S/ {{ saldo|round(2) }}

        <small>🏦Fondos de la cuenta</small>
    </div>
    <button class="btn-mas">+</button>
</div>

<div class="tarjeta">
    <h2>Misión - VIP{{ vip_nivel }}</h2>
    <small>Costo mejora: S/ {{ costo_vip }}👑</small>
    <div class="stats">
        <div class="stat">
            <span>{{ completados }}</span>
            <small>Completado</small>
        </div>
        <div class="stat">
            <span>{{ total_pedidos }}</span>
            <small>Todos</small>
        </div>
        <div class="stat">
            <span>{{ incompletos }}</span>
            <small>Incompleto</small>
        </div>
    </div>
    <div class="barra-progreso">
        <div class="progreso" style="width: {{ progreso }}%">{{ progreso | round(1) }}%</div>
    </div>
</div>


<form id="formMejorarVIP" method="POST" action="{{ url_for('mejorar_vip') }}">
  <div class="detalle">
    <span>"Esperamos que sigas disfrutando de los beneficios de ser parte de nuestra exclusiva comunidad."</span>
    <span>💸</span>
  </div>
  <div class="detalle">
    <span>Próximo VIP:</span>
    <span>VIP{{ vip_nivel + 1 if vip_nivel < 5 else vip_nivel }}</span>
  </div>
  <div class="detalle">
    <span>Costo mejora:</span>
    <span>S/ {{ costo_vip }}</span>
  </div>

  <div class="boton-container">
    {% if vip_nivel < 5 %}
      <button class="boton" type="submit">Mejorar VIP🎉</button>
    {% else %}
      <button class="boton" type="button" onclick="maxVip()">Ya tienes el nivel máximo</button>
    {% endif %}
  </div>
</form>







<script>
// Inyecta valores del servidor
const SALDO     = parseFloat('{{ "%.2f"|format(saldo) }}');
const COSTO_VIP = parseFloat('{{ "%.2f"|format(costo_vip) }}');
const NIVEL     = parseInt('{{ vip_nivel }}', 10);

// Intercepta el submit
document.getElementById("formMejorarVIP").addEventListener("submit", function(e) {
  e.preventDefault();

  // 1) Validar saldo
  if (SALDO < COSTO_VIP) {
    const faltante = (COSTO_VIP - SALDO).toFixed(2);
    Swal.fire({
      icon: 'error',
      title: 'Saldo insuficiente',
      html: `
        Necesitas <b>S/ ${COSTO_VIP.toFixed(2)}</b> para mejorar a VIP${NIVEL + 1}.<br>
        Te faltan <b>S/ ${faltante}</b>.
      `,
      confirmButtonColor: '#0a2c78'
    });
    return;
  }

  // 2) Confirmación si alcanza el saldo
  Swal.fire({
    title: '🚀 ¿Confirmar mejora?',
    text: `Se descontará S/ ${COSTO_VIP.toFixed(2)} de tu saldo.`,
    icon: 'warning',
    showCancelButton: true,
    confirmButtonColor: '#0a2c78',
    cancelButtonColor: '#d33',
    confirmButtonText: 'Sí, mejorar',
    cancelButtonText: 'Cancelar'
  }).then((result) => {
    if (result.isConfirmed) {
      e.target.submit();
    }
  });
});

// Mensaje cuando ya es el máximo
function maxVip(){
  Swal.fire({
    icon: 'info',
    title: '👑 Nivel máximo alcanzado',
    text: 'Ya tienes el VIP más alto disponible.',
    confirmButtonColor: '#0a2c78'
  });
}
</script>



            <!-- NAV INFERIOR -->
            <nav class="bottom-nav">
              <a href="{{ url_for('inicio') }}" class="nav-item"><i class="material-icons">home</i><span>INICIO</span></a>
              <a href="{{ url_for('pedido') }}" class="nav-item"><i class="material-icons">playlist_add_check</i><span>PEDIDO</span></a>
              <a href="{{ url_for('mision') }}" class="nav-item"><i class="material-icons">assignment</i><span>MISIÓN</span></a>
              <a href="{{ url_for('recarga') }}" class="nav-item"><i class="material-icons">payment</i><span>RECARGA</span></a>
              <a href="{{ url_for('yo') }}" class="nav-item"><i class="material-icons">person</i><span>YO</span></a>
            </nav>

</body>
</html>
